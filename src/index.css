@tailwind base;
@tailwind components;
@tailwind utilities;

/* Filla Design System v3.3 - "Dimensional Paper Edition"
   Tactile, neomorphic UI with warm paper tones
   All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Core Background & Foreground */
    --background: 40 20% 94%;      /* #F1EEE8 - Warm beige */
    --foreground: 248 15% 18%;     /* #2A293E - Dark ink */

    /* Surface Colors */
    --card: 0 0% 100%;               /* Pure white #ffffff for cards */
    --card-foreground: 248 15% 18%; /* Ink text */

    --popover: 0 0% 100%;
    --popover-foreground: 248 15% 18%;

    /* Primary - Teal */
    --primary: 182 29% 63%;          /* #8EC9CE */
    --primary-foreground: 0 0% 100%;
    --primary-deep: 182 23% 56%;     /* #71AEB3 - Darker teal */

    /* Secondary - Light paper tone */
    --secondary: 40 15% 96%;
    --secondary-foreground: 248 15% 18%;

    /* Muted */
    --muted: 40 12% 92%;
    --muted-foreground: 40 2% 55%;   /* #8C8C85 */

    /* Accent - Coral/Orange */
    --accent: 16 83% 56%;            /* #EB6834 */
    --accent-foreground: 0 0% 100%;

    /* Status Colors */
    --destructive: 0 84% 60%;        /* Red */
    --destructive-foreground: 0 0% 100%;

    --success: 145 62% 85%;          /* Light green */
    --success-foreground: 145 70% 25%;

    --warning: 43 100% 85%;          /* Light yellow */
    --warning-foreground: 43 100% 35%;

    --signal: 30 100% 91%;           /* Warm orange signal */
    --signal-foreground: 16 83% 56%;

    /* Borders & Inputs */
    --border: 40 12% 88%;            /* #E3DFD7 - Concrete */
    --input: 40 12% 88%;
    --ring: 182 29% 63%;             /* Primary teal */

    /* Special Tokens */
    --concrete: 40 12% 88%;          /* Border gray */
    --ink: 248 15% 18%;              /* Text color */

    /* Surface Gradient Tokens */
    --surface-gradient-from: 40 15% 95%;
    --surface-gradient-via: 40 12% 93%;
    --surface-gradient-to: 40 10% 91%;
    --input-bg: 40 10% 96%;

    --radius: 0.75rem;

    /* Sidebar - Deep Ink #2A293E = 248 15% 20% */
    --sidebar-background: 248 15% 20%;
    --sidebar-foreground: 0 0% 95%;
    --sidebar-primary: 182 29% 63%;           /* Teal accent */
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 248 12% 28%;            /* Lighter ink hover */
    --sidebar-accent-foreground: 0 0% 100%;
    --sidebar-border: 248 12% 25%;
    --sidebar-ring: 182 29% 63%;
    --sidebar-muted: 248 10% 40%;
  }

  .dark {
    /* Dark mode - Adjusted for paper aesthetic */
    --background: 248 15% 12%;
    --foreground: 40 20% 94%;

    --card: 248 15% 16%;
    --card-foreground: 40 20% 94%;

    --popover: 248 15% 16%;
    --popover-foreground: 40 20% 94%;

    --primary: 182 29% 63%;
    --primary-foreground: 248 15% 12%;
    --primary-deep: 182 23% 56%;

    --secondary: 248 10% 20%;
    --secondary-foreground: 40 20% 94%;

    --muted: 248 10% 22%;
    --muted-foreground: 40 5% 60%;

    --accent: 16 83% 56%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    --success: 145 62% 50%;
    --success-foreground: 0 0% 100%;

    --warning: 43 100% 60%;
    --warning-foreground: 248 15% 12%;

    --signal: 30 100% 70%;
    --signal-foreground: 248 15% 12%;

    --border: 248 10% 25%;
    --input: 248 10% 25%;
    --ring: 182 29% 63%;

    --concrete: 248 10% 25%;
    --ink: 40 20% 94%;
    /* Sidebar - Deep Ink dark mode */
    --sidebar-background: 248 15% 12%;
    --sidebar-foreground: 0 0% 95%;
    --sidebar-primary: 182 29% 63%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 248 12% 20%;
    --sidebar-accent-foreground: 0 0% 100%;
    --sidebar-border: 248 12% 18%;
    --sidebar-ring: 182 29% 63%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  /* Paper texture pattern - custom noise filter (exact as provided) */
  :root {
    --paper-texture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise-filter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.522' numOctaves='1' stitchTiles='stitch'%3E%3C/feTurbulence%3E%3CfeColorMatrix type='saturate' values='0'%3E%3C/feColorMatrix%3E%3CfeComponentTransfer%3E%3CfeFuncR type='linear' slope='0.468'%3E%3C/feFuncR%3E%3CfeFuncG type='linear' slope='0.468'%3E%3C/feFuncG%3E%3CfeFuncB type='linear' slope='0.468'%3E%3C/feFuncB%3E%3CfeFuncA type='linear' slope='0.137'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3CfeComponentTransfer%3E%3CfeFuncR type='linear' slope='1.323' intercept='-0.207'/%3E%3CfeFuncG type='linear' slope='1.323' intercept='-0.207'/%3E%3CfeFuncB type='linear' slope='1.323' intercept='-0.207'/%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise-filter)' opacity='0.8'%3E%3C/rect%3E%3C/svg%3E");
    --paper-gradient: linear-gradient(135deg, rgba(244,243,240,0.98) 0%, rgba(240,239,233,0.98) 50%, rgba(238,237,231,0.98) 100%);
  }

  body {
    @apply text-foreground;
    font-family: 'Inter Tight', system-ui, -apple-system, sans-serif;
    background-image: var(--paper-texture);
    background-size: 100%;
    background-color: hsl(var(--background));
  }
  
  /* Paper background for all main content areas */
  .bg-background,
  main,
  [role="main"],
  div[class*="bg-background"],
  div[class*="bg-white"] {
    background-image: var(--paper-texture) !important;
    background-size: 100% !important;
  }
  
  /* Cards use pure white with reduced opacity paper texture overlay */
  div[class*="bg-card"] {
    background-color: #ffffff !important;
    position: relative;
  }
  
  div[class*="bg-card"]::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image: var(--paper-texture);
    background-size: 100%;
    opacity: 0.3;
    pointer-events: none;
    z-index: 0;
    border-radius: inherit;
  }
  
  /* Ensure card content is above the texture overlay */
  div[class*="bg-card"] > * {
    position: relative;
    z-index: 1;
  }
  
  /* Modal paper texture */
  [role="dialog"],
  .dialog-content,
  [data-radix-popper-content-wrapper] > div {
    background-image: var(--paper-texture) !important;
    background-size: 100% !important;
  }

  /* Apply to specific background color classes */
  .bg-\[#F2F2EE\],
  .bg-\[#F4F3F0\],
  .bg-\[#F0EFE9\],
  .bg-\[#EEEDE7\] {
    background-image: var(--paper-texture) !important;
    background-size: 100% !important;
  }
  
  /* Font families */
  .font-sans {
    font-family: 'Inter Tight', system-ui, -apple-system, sans-serif;
  }
  
  .font-mono {
    font-family: 'JetBrains Mono', 'Menlo', 'Monaco', monospace;
  }
}

@layer utilities {
  /* Neomorphic Paper Shadows - Dimensional Paper Edition v3.5 */
  
  /* Flat Card - Default card style with texture */
  .shadow-e1 {
    box-shadow: 1px 3px 4px 0px rgba(0, 0, 0, 0.1), inset 1px 1px 1px rgba(255, 255, 255, 0.4);
  }
  
  /* Flat Section - For section backgrounds */
  .shadow-e2 {
    box-shadow: -1px -1px 1px 0px rgba(0, 0, 0, 0.1), inset -1px -1px 1px rgba(255, 255, 255, 0.53);
  }
  
  /* E3 - Floating modals/popovers */
  .shadow-e3 {
    box-shadow: 0 12px 32px rgba(0,0,0,0.12), 0 4px 12px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.9);
  }
  
  /* Engraved/debossed inputs */
  .shadow-engraved {
    box-shadow: 3px 4px 3px -3px rgba(255, 255, 255, 1), -2px -2px 5px -3px rgba(0, 0, 0, 0.05), inset -3px -3px 2px 0px rgba(0, 0, 0, 0.01), inset 1px 2px 2px 0px rgba(0, 0, 0, 0.08);
  }
  
  .shadow-paper-edge {
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.8);
  }
  
  /* Primary button shadow */
  .shadow-primary-btn {
    box-shadow: 3px 5px 5px 2px rgba(0, 0, 0, 0.13), -3px -3px 5px 0px rgba(255, 255, 255, 0.48), inset 1px 1px 2px 0px rgba(255, 255, 255, 0.5), inset -1px -2px 2px 0px rgba(0, 0, 0, 0.27);
  }
  
  /* Button pressed state */
  .shadow-btn-pressed {
    box-shadow: 0px 0px 7px 2px rgba(0, 0, 0, 0), inset -1px -2px 2px 0px rgba(255, 255, 255, 0.41), inset 3px 3px 4px 0px rgba(0, 0, 0, 0.17);
  }
  
  .shadow-fab {
    box-shadow: 0 8px 24px rgba(235,104,52,0.4), 0 4px 8px rgba(235,104,52,0.3);
  }
  
  /* ========================================
     SURFACE GRADIENTS & INPUT STYLES
     ======================================== */
  
  /* Surface Gradient Background */
  .bg-surface-gradient {
    background: linear-gradient(to bottom right, 
      hsl(var(--surface-gradient-from)), 
      hsl(var(--surface-gradient-via)), 
      hsl(var(--surface-gradient-to))
    );
  }
  
  /* Input Background */
  .bg-input {
    background-color: hsl(var(--input-bg));
  }
  
  /* Neomorphic Input Style */
  .input-neomorphic {
    @apply bg-input rounded-xl shadow-engraved border-0;
    @apply focus:ring-2 focus:ring-primary/30;
  }
  
  /* Neomorphic Button Style (from compliance dashboard) */
  .btn-neomorphic {
    @apply rounded-xl bg-surface-gradient;
    @apply shadow-[3px_5px_8px_rgba(174,174,178,0.25),-3px_-3px_6px_rgba(255,255,255,0.7),inset_1px_1px_1px_rgba(255,255,255,0.6)];
    @apply hover:scale-[1.01] active:scale-[0.99] transition-all duration-150;
    @apply text-foreground border-0;
  }
  
  /* Vibrant Accent Button (from compliance dashboard) */
  .btn-accent-vibrant {
    @apply rounded-xl text-white border-0;
    @apply shadow-[3px_5px_5px_2px_rgba(0,0,0,0.13),-3px_-3px_5px_0px_rgba(255,255,255,0.48),inset_1px_1px_2px_0px_rgba(255,255,255,0.5),inset_-1px_-2px_2px_0px_rgba(0,0,0,0.27)];
    @apply bg-accent hover:bg-accent/90;
  }
  
  /* Page Header Style */
  .page-header {
    @apply sticky top-0 z-40;
    /* Paper texture behind gradient so transparent areas reveal paper */
    background-image:
      linear-gradient(135deg, rgba(142, 201, 206, 1) 3%, rgba(142, 201, 206, 1) 28%, rgba(142, 201, 206, 0) 61%),
      var(--paper-texture);
    /* Blend gradient with texture so noise is visible even under teal */
    background-blend-mode: multiply, normal;
    background-size: 100% 100%, 100%;
    background-repeat: no-repeat, repeat;
    background-color: hsl(var(--background));
    border-color: rgba(0, 0, 0, 0);
    border-style: none;
    border-image: none;
    box-shadow: none;
  }
  
  /* Icon with Primary Color (from compliance dashboard) */
  .icon-primary {
    @apply text-primary;
  }
  
  /* Vibrant Status Colors for Badges (from compliance dashboard) */
  .badge-danger {
    @apply bg-destructive/10 text-destructive border-destructive/20;
  }
  
  .badge-warning {
    @apply bg-warning/20 text-warning-foreground border-warning/30;
  }
  
  .badge-success {
    @apply bg-success/20 text-success-foreground border-success/30;
  }
  
  /* ========================================
     NEO-SURFACE - Animated Neomorphic Hover
     ======================================== */
  
  /* Base neo-surface: transparent fill with shadow top-left, highlight bottom-right */
  .neo-surface {
    position: relative;
    background: transparent;
    border-radius: 5px;
    box-shadow: 
      /* Top-left shadow (depth) */
      -3px -3px 6px 0px rgba(0, 0, 0, 0.25),
      /* Bottom-right highlight (light) */
      3px 3px 6px 0px rgba(255, 255, 255, 0.15),
      /* Inner top-left shadow */
      inset -1px -1px 2px 0px rgba(0, 0, 0, 0.15),
      /* Inner bottom-right highlight */
      inset 1px 1px 2px 0px rgba(255, 255, 255, 0.08);
    transition: box-shadow 150ms ease-in, transform 150ms ease-in;
  }
  
  .neo-surface::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, transparent 50%, rgba(0, 0, 0, 0.05) 100%);
    opacity: 0;
    transition: opacity 150ms ease-in;
    pointer-events: none;
  }
  
  .neo-surface:hover {
    box-shadow: 
      /* Deeper top-left shadow */
      -4px -4px 8px 0px rgba(0, 0, 0, 0.35),
      /* Brighter bottom-right highlight */
      4px 4px 8px 0px rgba(255, 255, 255, 0.2),
      /* Inner top-left shadow */
      inset -2px -2px 3px 0px rgba(0, 0, 0, 0.2),
      /* Inner bottom-right highlight */
      inset 2px 2px 3px 0px rgba(255, 255, 255, 0.12);
    transition: box-shadow 180ms ease-out, transform 180ms ease-out;
  }
  
  .neo-surface:hover::before {
    opacity: 1;
    transition: opacity 180ms ease-out;
  }
  
  .neo-surface:focus-visible {
    outline: none;
    box-shadow: 
      -4px -4px 8px 0px rgba(0, 0, 0, 0.35),
      4px 4px 8px 0px rgba(255, 255, 255, 0.2),
      inset -2px -2px 3px 0px rgba(0, 0, 0, 0.2),
      inset 2px 2px 3px 0px rgba(255, 255, 255, 0.12),
      0 0 0 2px hsl(var(--sidebar-primary));
  }
  
  /* Neo-surface active/pressed state */
  .neo-surface-active,
  .neo-surface:active {
    box-shadow: 
      /* Inverted: highlight top-left, shadow bottom-right (pressed in) */
      -2px -2px 4px 0px rgba(255, 255, 255, 0.1),
      2px 2px 4px 0px rgba(0, 0, 0, 0.3),
      inset -3px -3px 5px 0px rgba(255, 255, 255, 0.08),
      inset 3px 3px 5px 0px rgba(0, 0, 0, 0.25);
    transition: box-shadow 100ms ease-out;
  }
  
  .neo-surface-active::before,
  .neo-surface:active::before {
    opacity: 0;
  }
  
  /* Override neo-surface box-shadow when shadow-none is present */
  .neo-surface.shadow-none,
  .shadow-none.neo-surface {
    box-shadow: none !important;
  }
  
  .neo-surface.shadow-none:hover,
  .shadow-none.neo-surface:hover {
    box-shadow: none !important;
  }
  
  .neo-surface.shadow-none:active,
  .shadow-none.neo-surface:active {
    box-shadow: none !important;
  }
  
  .neo-surface.shadow-none:focus-visible,
  .shadow-none.neo-surface:focus-visible {
    box-shadow: 0 0 0 2px hsl(var(--sidebar-primary)) !important;
  }
  
  /* Light mode variant */
  .neo-surface-light {
    position: relative;
    background: transparent;
    border-radius: 5px;
    box-shadow: 
      -2px -2px 4px 0px rgba(0, 0, 0, 0.08),
      2px 2px 4px 0px rgba(255, 255, 255, 0.9),
      inset -1px -1px 2px 0px rgba(0, 0, 0, 0.05),
      inset 1px 1px 2px 0px rgba(255, 255, 255, 0.6);
    transition: box-shadow 150ms ease-in;
  }
  
  .neo-surface-light::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.5) 0%, transparent 50%, rgba(0, 0, 0, 0.03) 100%);
    opacity: 0;
    transition: opacity 150ms ease-in;
    pointer-events: none;
  }
  
  .neo-surface-light:hover {
    box-shadow: 
      -3px -3px 6px 0px rgba(0, 0, 0, 0.12),
      3px 3px 6px 0px rgba(255, 255, 255, 1),
      inset -2px -2px 3px 0px rgba(0, 0, 0, 0.08),
      inset 2px 2px 3px 0px rgba(255, 255, 255, 0.8);
    transition: box-shadow 180ms ease-out;
  }
  
  .neo-surface-light:hover::before {
    opacity: 1;
    transition: opacity 180ms ease-out;
  }
  
  /* Paper texture utility class - can be applied to any element */
  .bg-paper-texture {
    background-image: var(--paper-texture);
    background-size: 100%;
  }

  /* Card backgrounds with texture - updated to use inline SVG */
  .bg-card-flat {
    background-color: hsl(40 10% 90%);
    background-image: var(--paper-texture);
  }

  /* Unified card-flat class - single source of truth */
  .card-flat {
    background-color: rgba(241, 238, 232, 0.49);
    background-image: var(--paper-texture);
    background-size: 100%;
    border-radius: 8px;
    box-shadow: 1px 3px 4px 0px rgba(0, 0, 0, 0.1), inset 1px 1px 1px rgba(255, 255, 255, 0.4);
  }
  
  .bg-section-flat {
    background-color: rgba(182, 184, 164, 0.74);
    background-image: var(--paper-texture);
    background-size: 100%;
  }
  
  /* Neumorphic Text Shadows for headings */
  .text-shadow-neu {
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8), -1px -1px 1px rgba(0, 0, 0, 0.1);
  }
  
  .text-shadow-neu-emboss {
    text-shadow: 2px 2px 3px rgba(255, 255, 255, 0.9), -1px -1px 2px rgba(0, 0, 0, 0.15);
  }
  
  /* Global Heading Styles - Single source of truth */
  .heading-xl {
    text-shadow: var(--heading-xl-shadow, 2px 2px 3px rgba(255, 255, 255, 0.9), -1px -1px 2px rgba(0, 0, 0, 0.15));
  }
  
  .heading-l {
    text-shadow: var(--heading-l-shadow, 1px 1px 2px rgba(255, 255, 255, 0.8), -1px -1px 1px rgba(0, 0, 0, 0.1));
  }
  
  /* Scrollbar hide utility */
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  /* Gradient mask for scroll indicators */
  .mask-gradient-right {
    mask-image: linear-gradient(to right, black 90%, transparent 100%);
    -webkit-mask-image: linear-gradient(to right, black 90%, transparent 100%);
  }
  
  /* Animated Icon Path Drawing Animations - Inspired by animate-ui.com */
  /* Uses stroke-dasharray to create path drawing effect on hover */
  .animate-icon-path-draw svg path,
  [data-animation="path-draw"] svg path {
    stroke-dasharray: 1000;
    stroke-dashoffset: 1000;
    transition: stroke-dashoffset 0.6s ease-in-out, opacity 0.3s ease-in-out;
  }
  
  .animate-icon-path-draw:hover svg path,
  [data-animation="path-draw"]:hover svg path {
    stroke-dashoffset: 0;
    opacity: 1;
  }
  
  /* Ensure icons have stroke for path drawing to work */
  .animate-icon-path-draw svg,
  [data-animation="path-draw"] svg {
    stroke: currentColor;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
  }

  /* FlyonUI Chat Components */
  .chat {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .chat-sender {
    align-items: flex-end;
  }

  .chat-receiver {
    align-items: flex-start;
  }

  .chat-avatar {
    flex-shrink: 0;
  }

  .chat-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    font-weight: 500;
    margin-bottom: 0.25rem;
  }

  .chat-header time {
    font-size: 0.75rem;
    opacity: 0.7;
  }

  .chat-bubble {
    padding: 0.75rem 1rem;
    border-radius: 1rem;
    max-width: 80%;
    word-wrap: break-word;
  }

  .chat-sender .chat-bubble {
    background-color: hsl(var(--primary));
    color: hsl(var(--primary-foreground));
    border-bottom-right-radius: 0.25rem;
  }

  .chat-receiver .chat-bubble {
    background-color: hsl(var(--muted));
    color: hsl(var(--foreground));
    border-bottom-left-radius: 0.25rem;
  }

  .chat-footer {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.75rem;
    margin-top: 0.25rem;
  }

  /* Base content color utilities */
  .text-base-content {
    color: hsl(var(--foreground));
  }

  .text-base-content\/50 {
    color: hsl(var(--muted-foreground));
  }

  .text-base-content\/80 {
    color: hsl(var(--foreground) / 0.8);
  }

  .bg-base-100 {
    background-color: hsl(var(--background));
  }

  .text-success {
    color: hsl(var(--success-foreground));
  }
}
